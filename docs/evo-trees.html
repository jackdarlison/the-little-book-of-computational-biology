<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Evolutionary Trees - The Little Book of Computational Biology</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="chapter-item expanded "><a href="DNA.html"><strong aria-hidden="true">1.</strong> DNA</a></li><li class="chapter-item expanded "><a href="cells.html"><strong aria-hidden="true">2.</strong> Protein and Cells</a></li><li class="chapter-item expanded "><a href="transcription-networks.html"><strong aria-hidden="true">3.</strong> Transcription Networks</a></li><li class="chapter-item expanded "><a href="sequence-matching.html"><strong aria-hidden="true">4.</strong> Sequence Matching</a></li><li class="chapter-item expanded "><a href="hmm.html"><strong aria-hidden="true">5.</strong> Hidden Markov Models</a></li><li class="chapter-item expanded "><a href="neural.html"><strong aria-hidden="true">6.</strong> Neural Applications</a></li><li class="chapter-item expanded "><a href="population-dynamics.html"><strong aria-hidden="true">7.</strong> Population Dynamics</a></li><li class="chapter-item expanded "><a href="evo-trees.html" class="active"><strong aria-hidden="true">8.</strong> Evolutionary Trees</a></li><li class="chapter-item expanded "><a href="boolean-networks.html"><strong aria-hidden="true">9.</strong> Boolean Networks</a></li><li class="chapter-item expanded "><a href="epigenetics.html"><strong aria-hidden="true">10.</strong> Epigenetics</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Little Book of Computational Biology</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/jackdarlison/the-little-book-of-computational-biology" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="evolutionary-trees"><a class="header" href="#evolutionary-trees">Evolutionary Trees</a></h1>
<p><strong>Phylogeny</strong> is the study of the evolution of a species or group. This is usually represented using a tree, which help groups the different kinds of living things </p>
<p>The Tree is built up from external features as well as DNA. However, feature based trees can be misleading due to convergent evolution </p>
<p>We can see using Mitochondrial DNA that all Humans share a common ancestor from around 155,000 years ago. Mitochondrial DNA only comes from the mother, thus it is asexually passed on. Cross breeding with other hominids meant over time only homo-sapians were left. </p>
<p>Statistically asexual reproduction creates to a single line from one original ancestor to the entire current generation.</p>
<p>Entire Life <strong>Phylogenetic</strong> trees are not actually trees as horizontal gene transfer is present in Bacteria and Archaea. These reproduce asexually but can exchange DNA to evolve. </p>
<p>However As most multicellular organisms cannot interbreed, we can model them using trees. </p>
<p>To use DNA to build up a phylogeny tree we look at Homologous (the same) genes. Genes that diverge due to speciation are orthologues whereas genes that diverge due to supplication are paralogues. To understand how species relate to each other we need to use orthologues.</p>
<p>To build a tree we need a molecular clock. To do this we presume that mutations occur at a constant rate; they don't due to selection and random processes so it is best to use large sequences.</p>
<p>A perfect molecular clock would give us an ultra metric structure, i.e. long-sided isosceles. Defined as for any three nodes, the maximum distance between two is <strong>not</strong> unique</p>
<h4 id="distance-based-trees"><a class="header" href="#distance-based-trees">Distance Based Trees</a></h4>
<p>These trees explain a table of distances between DNA, e.g. sequence edit distance</p>
<p>Unweighted Pairwise Group Method using Arithmetic Averaging (<strong>UPGMA</strong>) is a method of creating a distance based tree. All nodes begin in single node clusters then we repeat until all merged:</p>
<ul>
<li>Calculate the distance between clusters: \( d_{kl} = \frac{1}{|C_k||C_l|}\sum_{p\in C_k; q\in C_l}d_pq \)</li>
<li>Repeat Select the two clusters</li>
<li>Remove all nodes and replace with a joined cluster</li>
<li>Distance to remaining clusters are: \( d_{kl} = \frac{d_il|C_i| + d_{jl}|C_j|}{|C_i| + |C_j|} \)</li>
</ul>
<p>For a distance metric between two sequences we could use the negative log of (1 - number of mismatched letters): \( d_{ij} = -\log(1-p_{ij}) \) </p>
<p>UPGMA imposes the ultra metric structure on trees. however, we can not always assume that trees will be ultra-metric.</p>
<p>UPGMA gives a good idea of evolutionary time</p>
<p>Another distance based tree are <strong>Additive Trees</strong>, which don't assume a perfect molecular clock and thus don;t assume the tree is ultra-metric.</p>
<p>Instead we assume <strong>Additivity</strong>, which assumes that mutations accumulate but not at a constant rate. In addition, mutations are independent of each other. </p>
<p>For additive trees the closest nodes are not necessarily neighbours, so we cant just pick the closest two pairs and join them. We need to compensate for high weighted arcs. To do this we subtract the averaged distances from each node to all other nodes:</p>
<p>\[ D_{ab} = d_{ab} - r_a - r_b; \text{ where }r_i = \frac{1}{|L| - 2}\sum_{n\in L}d_{in} \]</p>
<p>We then repeat until all nodes joined:</p>
<ul>
<li>Create new node k and join the two closest nodes to it (smallest \(D_{ij} \))</li>
<li>Calculate the distances \( d_{ki} \) between k and all other nodes</li>
<li>Calculate distances from k to both i and j using \( d_{ki} = \frac{1}{2}(d_{ij} + r_i - r_j) \)</li>
<li>Calculate the weighted distance \( D_{ki} \) between k and all other nodes</li>
<li>Remove i and j from the distance matrix and add k</li>
</ul>
<p>Additivity requires that mutations accumulate. However this does not happen where backward mutations exist and two species find the same mutation. Thus, it is better to use parts of the genome which are known to not have backward mutations</p>
<p>Additive trees give a good idea of evolutionary distance. </p>
<h4 id="sequence-based-trees"><a class="header" href="#sequence-based-trees">Sequence Based Trees</a></h4>
<p>We want to find the tree that explains the evolutionary history of a set of sequences with as few mutations as possible </p>
<p>We can use maximum parsimony trees for this, which uses aligned sequences. However, there is no efficient algorithm for this so need to iterate through all possible trees</p>
<p>We want to find the lowest cost tree. we need to create a cost:</p>
<ul>
<li>Assume each site is independent</li>
<li>Assumes a binary tree where leaves are sequences</li>
<li>Total cost is the sum of the costs at each site (this could be number of substitutions are BLOSUM50 costs, etc. )</li>
</ul>
<p>We then enumerate all the trees to find the one with the lowest cost. However this is costly. We can use Branch and Bound (i.e. pruning) to reduce the search space. This involves removing subtrees which have a higher cost than the cheapest found as it can never become cheaper</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="population-dynamics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="boolean-networks.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="population-dynamics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="boolean-networks.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
