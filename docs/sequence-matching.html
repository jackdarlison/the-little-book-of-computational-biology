<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sequence Matching - The Little Book of Computational Biology</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="chapter-item expanded "><a href="DNA.html"><strong aria-hidden="true">1.</strong> DNA</a></li><li class="chapter-item expanded "><a href="cells.html"><strong aria-hidden="true">2.</strong> Cells</a></li><li class="chapter-item expanded "><a href="transcription-networks.html"><strong aria-hidden="true">3.</strong> Transcription Networks</a></li><li class="chapter-item expanded "><a href="sequence-matching.html" class="active"><strong aria-hidden="true">4.</strong> Sequence Matching</a></li><li class="chapter-item expanded "><a href="hmm.html"><strong aria-hidden="true">5.</strong> Hidden Markov Models</a></li><li class="chapter-item expanded "><a href="population-dynamics.html"><strong aria-hidden="true">6.</strong> Population Dynamics</a></li><li class="chapter-item expanded "><a href="evo-trees.html"><strong aria-hidden="true">7.</strong> Evolutionary Trees</a></li><li class="chapter-item expanded "><a href="boolean-networks.html"><strong aria-hidden="true">8.</strong> Boolean Networks</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Little Book of Computational Biology</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/jackdarlison/the-little-book-of-computational-biology" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="sequence-matching"><a class="header" href="#sequence-matching">Sequence Matching</a></h1>
<p>Sequence matching is useful for:</p>
<ul>
<li>Finding similarity in Protein/DNA between related species </li>
<li>Transfer knowledge about known sequences to new sequences</li>
<li>Compare sequences with other species, although need to know which part of the sequence to match</li>
</ul>
<p>To reassemble sequences after sequencing, we need to find best matches at both the DNA and Protein levels</p>
<p>Mutations in proteins are more likely to have adverse effects than DNA, meaning they are more highly conserved. This means they are unlikely to change between generations, species, or even kingdoms. DNA mutation are les conserved as the often have no effect</p>
<p>Some coding sequences are so important they are conserved in all living things, i.e the coding for proteins used in transcription and translation. All inherited from the universal common ancestor. </p>
<p>Some amino acids are more similar to each other, meaning they have a higher chance of being substituted with each other. </p>
<p>BLOSUM 50 is a data set of substitution rates, using known alignments it is calculated by:</p>
<ul>
<li>Eliminating sequences with higher than a given similarity</li>
<li>Calculating frequency of pairs of amino acids</li>
<li>Calculate the ratio of occurrence of each amino acid combination.</li>
<li>Calculate log odds of each pair, i.e. how often they occur as a pair compared to how often then would be expected if independent: \[ 2\log_2(\frac{P_{ab}}{P_aP_b}) \]</li>
</ul>
<p>The BLOSUM 50 table can be used to look up the probability of the \(i\)th amino mutating to the \(j\)th amino acid</p>
<p>It is also a possibility that there could be a gap, i.e. a insertion or deletion. </p>
<p>As there is an infeasible number of possible inexact matches to check, so we use dynamic programming to build up an optimal set of partial solutions until we have a solution for the entire string. Each step builds upon the previous optimal solutions. Dynamic programming reduces the complexity from O(\(2^n\)) to O(\(n^2\))</p>
<h3 id="exact-methods"><a class="header" href="#exact-methods">Exact Methods</a></h3>
<p><strong>Needleman-Wunsch</strong> is an algorithm for computing global alignments between two strings. </p>
<ul>
<li>BLOSUM 50 is used for substitution costs, a to b</li>
<li>Linear cost (d = -8) is used for insertion and deletion</li>
</ul>
<p>We use the costs to build up a cost matrix \(F\) where each cell (n, m) gives the best alignment for strings \(a_{0:n} \) and \(b_{0:m}\). The top left is the start, which is filled with 0. This is done recursively with the equation: \[ F_{i, j} = \max \begin{cases} F_{i-1, j-1} + S_{a_i, b_j} \\ F_{i-1, j} + d \\ F_{i, j-1} + d \end{cases}\]</p>
<p>Corresponding to substitution, a gap, b gap respectively. </p>
<p>At each cell a pointer is kept to indicate which previous state the cell came from (i.e. the action used). After the table is filled we start at the bottom right and follow the back pointers to find the best alignment. </p>
<p>NW global matching has a time complexity of O(A size x B size) which is not an issue. The main problem is it has the same space complexity making it a problem for long sequences. </p>
<p><em>Hirschberg</em> is another global matching algorithm which recursively splits up the string making it have linear space complexity. Is still quadratic in time, but in practise tends to take twice as long as NW</p>
<p><strong>Smith-Waterman</strong> is an algorithm for local matching, finds the best aligned substring within two strings. </p>
<p>It is very similar to NW, with the added option of ignoring an operation for a cost of 0: \[ F_{i, j} = \max \begin{cases} 0 \\ F_{i-1, j-1} + S_{a_i, b_j} \\ F_{i-1, j} + d \\ F_{i, j-1} + d \end{cases} \]</p>
<p>The table is filled in the same way, using back pointers to the previous cell if the operation wasn't ignore. </p>
<p>Once it is filled, we start from the highest value in the table rather than the last value, and follow the points until we reach a 0 to find the local alignment. </p>
<p>To deal with multiple best matches, caused by repeats of one region within another, smith-waterman can be adapted. </p>
<p>Both NW and SW use linear gap costs, i.e. each site is independent. This is problematic as in reality mutations can occur in sequences.</p>
<p>To fix this we add an affine (linear, i.e. y = mx +c) gap cost function evaluated over all previous possible gap sizes: \( \gamma(g) = -d - e(g-1) \). d=12 and e=3 gives a good model which penalises all gaps but larger slightly more punished. </p>
<p>To implement this however, three matrices are needed. It is easier to visualise these using finite state automata, where the states are the matrices and arcs are the operation costs</p>
<h3 id="approximate-methods"><a class="header" href="#approximate-methods">Approximate Methods</a></h3>
<p>Proteins we have chains of 100s of amino acids, meaning the quadratic time of these algorithms is possible, but slow.</p>
<p>DNA however is 10^5 to 10^11 bases long, meaning quadratic time is not feasible. To achieve this we need approximate methods</p>
<p><strong>FASTA</strong> is a heuristic method that finds candidate subsequences for alignments. Smith-waterman is then used of the subsequences. It has however been superseded by BLASTA</p>
<p><strong>BLASTA</strong> is another heuristic method which:</p>
<ul>
<li>filters out low complexity regions or repeated sequences</li>
<li>make k-letter exact matches word list from the sequence</li>
<li>evaluates of <em>significant</em> matches</li>
<li>Combines high scoring matches to find gapped regions.</li>
<li>Finishes off with Smith Waterman</li>
</ul>
<p>The find the significance of a match, i.e. the probability of a match given sequences a and b we can use the logistic equation on the probabilities: </p>
<p>\[ P(M|a, b) = \sigma (\log\frac{P(a, b|M)}{P(a, b|R)} + \log\frac{P(M)}{P(R)}) \]</p>
<p>Another approach is finding the likelihood of a particular score being random rather than a match is to use <em>extreme value distributions</em>.</p>
<p><img src="EVD.png" alt="EVD" /></p>
<p>Where we sample multiple distributions, and take the most extreme value of each distribution to create an extreme value distribution.</p>
<p>EVDs are more accurate the longer the string.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="transcription-networks.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="hmm.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="transcription-networks.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="hmm.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
